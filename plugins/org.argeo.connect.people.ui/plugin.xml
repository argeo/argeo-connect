<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
	<!-- Perspective --> 
	<extension
    	point="org.eclipse.ui.perspectives">
		<perspective
			class="org.argeo.connect.people.ui.PeoplePerspective"
			icon="icons/people.gif"
            id="org.argeo.connect.people.ui.peoplePerspective"
            name="People">
      </perspective>
   </extension>
    <!-- Views -->
    <extension
		point="org.eclipse.ui.views">
		<view
			class="org.argeo.eclipse.spring.SpringExtensionFactory"
			icon="icons/person.gif"
			id="org.argeo.connect.people.ui.peopleBrowserView"
			name="People Browser"
			restorable="true">
		</view>
		<view
			class="org.argeo.eclipse.spring.SpringExtensionFactory"
			icon="icons/people.gif"
			id="org.argeo.connect.people.ui.categorizedSearchView"
			name="People Search"
			restorable="true">
		</view>
	</extension>
    <extension
		point="org.eclipse.ui.editors">
		<editor
			class="org.argeo.eclipse.spring.SpringExtensionFactory"
			icon="icons/search.png"
			id="org.argeo.connect.people.ui.searchEntityEditor"
			name="Search">
		</editor>
		<editor
			class="org.argeo.eclipse.spring.SpringExtensionFactory"
			icon="icons/group.gif"
			id="org.argeo.connect.people.ui.groupEditor"
			name="Group">
		</editor>
		<editor
			class="org.argeo.eclipse.spring.SpringExtensionFactory"
			icon="icons/mailingList.gif"
			id="org.argeo.connect.people.ui.mailingListEditor"
			name="Mailing List">
		</editor>
	</extension>
	<!-- Commands -->
	<extension
		point="org.eclipse.ui.commands">
		<!-- Generic Check in and out introduced by people -->
		<command
      		id="org.argeo.connect.people.ui.checkOutItem"
            name="checkOutItem">
    	</command>
    	<command
      		id="org.argeo.connect.people.ui.cancelAndCheckInItem"
            name="cancelAndcheckInItem">
    	</command>
		
		<!-- Legacy: import big data --> 
		<command
			defaultHandler="org.argeo.eclipse.spring.SpringCommandHandler"
			id="org.argeo.connect.people.ui.importPeople"
			name="Import people">
		</command>    
		
		<!-- Entity CRUD --> 
		<command
			defaultHandler="org.argeo.eclipse.spring.SpringExtensionFactory"
      		id="org.argeo.connect.people.ui.deleteEntity"
            name="deleteEntity">
            <commandParameter
         		id="param.toRemoveJcrId"
         		name="Jcr ID of the node to remove">
  	 		</commandParameter>
            <commandParameter
         		id="param.removeParent"
         		name="Indicates whether parent node should also be deleted">
  	 		</commandParameter>
    	</command>
		
		<!-- Entity References CRUD --> 
		<command
			defaultHandler="org.argeo.eclipse.spring.SpringExtensionFactory"
      		id="org.argeo.connect.people.ui.removeEntityReference"
            name="removeEntityReference">
            <commandParameter
         		id="param.versionableParentJcrId"
         		name="Jcr ID of the nearest versionable ancestor">
  	 		</commandParameter>
            <commandParameter
         		id="param.toRemoveJcrId"
         		name="Jcr ID of the node to remove">
  	 		</commandParameter>
    	</command>
    	<command
			defaultHandler="org.argeo.eclipse.spring.SpringExtensionFactory"
      		id="org.argeo.connect.people.ui.editEntityReference"
            name="editEntityReference">
            <commandParameter
         		id="param.versionableParentJcrId"
         		name="Jcr ID of the nearest versionable ancestor">
  	 		</commandParameter>
            <commandParameter
         		id="param.toEditJcrId"
         		name="Jcr ID of the node to edit">
  	 		</commandParameter>
    	</command>
    	<command
			defaultHandler="org.argeo.eclipse.spring.SpringExtensionFactory"
      		id="org.argeo.connect.people.ui.addEntityReferences"
            name="Add Entity References">
            <commandParameter
         		id="param.referencingJcrId"
         		name="Referencing node JCR identifier">
  	 		</commandParameter>
            <commandParameter
         		id="param.referencedJcrId"
         		name="Referenced node JCR identifier">
  	 		</commandParameter>
    	</command>
    	<command
			defaultHandler="org.argeo.eclipse.spring.SpringExtensionFactory"
      		id="org.argeo.connect.people.ui.addEntityReferenceWithPosition"
            name="Add Entity References With Position">
            <commandParameter
         		id="param.referencingJcrId"
         		name="Referencing node JCR identifier">
  	 		</commandParameter>
            <commandParameter
         		id="param.referencedJcrId"
         		name="Referenced node JCR identifier">
  	 		</commandParameter>
            <commandParameter
         		id="param.toSearchNodeType"
         		name="type of node to search for">
  	 		</commandParameter>
    	</command>
		<command
			defaultHandler="org.argeo.eclipse.spring.SpringExtensionFactory"
      		id="org.argeo.connect.people.ui.editEntityReferenceWithPosition"
            name="Edit Entity References With Position">
            <commandParameter
         		id="param.oldLinkJcrId"
         		name="Old link JCR identifier">
  	 		</commandParameter>
            <commandParameter
         		id="param.isBackward"
         		name="Direction of the link">
  	 		</commandParameter>
            <commandParameter
         		id="param.toSearchNodeType"
         		name="type of node to search for">
  	 		</commandParameter>
    	</command>
    	
    	<!-- Utility to provide sub menues when we don't want to define a default command for this menu -->
		<command
			defaultHandler="org.argeo.connect.people.ui.commands.DoNothing"
			id="org.argeo.connect.people.ui.doNothing"
			name="Open menu">
		</command>    
		<!-- <command
			defaultHandler="org.argeo.eclipse.spring.SpringCommandHandler"
			id="org.argeo.connect.people.ui.openEntityEditor"
			name="Open Network Editor">
			 <commandParameter
         		id="param.entityType"
         		name="Entity Node Type">
  	 		</commandParameter>
			 <commandParameter
         		id="param.entityUid"
         		name="The Model Specific Entity Uid">
  	 		</commandParameter>
		</command>    
		<command
			defaultHandler="org.argeo.connect.people.ui.commands.OpenSearchEntityEditor"
			id="org.argeo.connect.people.ui.openSearchEntityEditor"
			name="Open Search Entity Editor">
			 <commandParameter
         		id="param.entityType"
         		name="Entity Node Type">
  	 		</commandParameter>
		</command> -->   
	</extension>		
	<!-- Menus -->
	<extension
		point="org.eclipse.ui.menus">
		<!-- Popup Menu for NetworkBrowserView-->
		<!-- View Specific Menus --> 
		<menuContribution
        	locationURI="toolbar:org.argeo.connect.people.ui.peopleBrowserView">
            <command
            	commandId="org.argeo.connect.people.ui.importPeople"
                icon="icons/people.gif"
                label="Import"
                tooltip="Import People">
            </command>
        </menuContribution>
	</extension>
	<extension
		point="org.eclipse.ui.activities">
		<activity
              description="Only for admins"
              id="org.argeo.connect.people.ui.adminActivity"
              name="People Admin">
		  <enabledWhen>
		    <with variable="roles">
		      <iterate ifEmpty="false" operator="or">
		        <equals value="ROLE_PEOPLE_ADMIN" />
		      </iterate>
		    </with>
		  </enabledWhen>
        </activity>
        <activityPatternBinding
              activityId="org.argeo.connect.people.ui.adminActivity"
              isEqualityPattern="true"
              pattern="org.argeo.connect.people.ui/org.argeo.connect.people.ui.peoplePerspective">
        </activityPatternBinding>
     </extension>
</plugin>
